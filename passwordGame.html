<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>لعبة كلمة المرور — اليوم الوطني السعودي 95</title>
<style>
  :root{
    --bg:#00343a;
    --panel:#001c1f;
    --text:#ffffff;
    --title:#83ab40;
    --muted:#7570b2;
    --red:#961a4d;
    --green:#058246;
    --logoH:clamp(44px,6vw,88px);
    font-family:"Segoe UI",Roboto,"Noto Naskh Arabic",system-ui
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);text-align:right}

  .brandbar{max-width:1100px;margin:18px auto 8px;padding:0 12px}
  .brandgrid{display:grid;grid-template-columns:1fr auto 1fr;grid-template-areas:"left center right";align-items:center;gap:16px}
  .slot{display:flex;align-items:center}
  .slot.left{grid-area:left;justify-content:flex-start}
  .slot.center{grid-area:center;justify-content:center}
  .slot.right{grid-area:right;justify-content:flex-end}

  .slot img{height:var(--logoH);max-height:var(--logoH);width:auto;display:block;object-fit:contain}
  #logo-ref{height:var(--logoH)}

  .wrap{max-width:900px;margin:14px auto 32px;padding:20px;background:var(--panel);border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,.3)}
  h1{margin:0 0 10px;font-size:20px;color:var(--title)}

  .game{display:grid;grid-template-columns:1fr 360px;gap:16px}
  @media(max-width:880px){.game{grid-template-columns:1fr}}

  .left,.right{padding:16px;border-radius:10px;min-height:150px}
  label{display:block;margin-bottom:6px;color:var(--muted)}
  input[type="text"]{width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,.12);background:transparent;color:inherit;font-size:16px;box-sizing:border-box;direction:ltr;text-align:left}
  .small{font-size:13px;color:var(--muted)}
  .conditions{margin-top:14px;display:flex;flex-direction:column;gap:8px}
  .cond{padding:12px;border-radius:8px;background:rgba(255,255,255,.02);display:flex;align-items:center;justify-content:space-between;border:2px solid rgba(255,255,255,.08)}
  .status{display:flex;align-items:center;gap:8px;font-weight:600}
  .dot{width:10px;height:10px;border-radius:50%}
  .dot.red{background:var(--red)}
  .dot.green{background:var(--green)}
  .cond.red{border-color:var(--red)}
  .cond.green{border-color:var(--green)}
  .final-message{display:none;font-size:23px;font-weight:bold;color:var(--test);text-align:center;margin-top:100px}
  .mobile-only{display:none}
  .desktop-only{display:block}
  @media(max-width:880px){.mobile-only{display:block}.desktop-only{display:none}.final-message{margin-top:12px}}
</style>
</head>
<body>
  <div class="brandbar">
    <div class="brandgrid">
      <div class="slot right">
        <a href="https://cyber.kku.edu.sa" title="الأمن السيبراني بجامعة الملك خالد">
          <img id="logo-left" src="logo.png" alt="Cyber Logo">
        </a>
      </div>
      <div class="slot center">
        <img id="logo-ref" src="https://nd.gea.gov.sa/assets/national-day-logo-BKoUmlkE.svg" alt="National Day">
      </div>
      <div class="slot left">
        <a href="https://kku.edu.sa" title="جامعة الملك خالد">
          <img id="logo-right" src="https://cyber.kku.edu.sa/themes/custom/kkucyber/logo.svg" alt="KKU Logo">
        </a>
      </div>
    </div>
  </div>

  <div class="wrap">
    <h1>لعبة كلمة المرور — اليوم الوطني السعودي 95</h1>
    <div class="final-message mobile-only" id="successTop">🎉 أبدعت! كل شيء تمام 🎉</div>

    <div class="game">
      <div class="left">
        <label>دخل كلمة المرور، كلها بالإنجليزي إلا وحدة….</label>
        <input id="pwd" type="text" placeholder="اكتب كلمة المرور هنا..." autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false"/>
        <div class="small">مجموع الأرقام: <span id="digitSum">0</span></div>
        <div class="conditions" id="conditionsContainer"></div>
      </div>
      <div class="right">
        <div class="final-message desktop-only" id="successRight">وعيك السيبراني أمان لك ولنا…
</br>والله يحفظ وطننا وحكامنا وشعبنا‫</br></br>الإدارة العامة للأمن السيبراني</br></br>جامعة الملك خالد</div>‬
      </div>
    </div>
  </div>

<script>
const A={
  minLen:12,
  natDay:"23-09",
  flagEmoji:"🇸🇦",
  currency:"SAR",
  domain:".sa",
  unificationYearAD:"1932",
  unificationYearAH:"1351",
  founderName:"Abdulaziz",
  visionYear:"2030",
  horseName:"عبية",
  royalTitle:"AlSaud",
  currentKing2025:"Salman",
  swordsPalmEmojis:["⚔️","🌴"],
  regions:["Eastern","Riyadh","Jazan","Najran","Asir","Hail","Makkah","Madinah","Tabuk","Al-Baha","Al-Jouf","Northern Borders","Al-Qassim"]
};

const CONDITIONS=[
  {key:'minLen',title:'الله البادي ثم مجد بلادي🎶… طول كلمة المرور 12 فأكثر'},
  {key:'hasDigit',title:'نحتاج رقم واحد على الأقل'},
  {key:'hasUpper',title:'حرف إنجليزي كبير يرفع المزاج'},
  {key:'hasLower',title:'حرف صغير يكمل الصورة'},
  {key:'hasSpecial',title:'رمز مميز يعطي نكهة'},
  {key:'natDay',title:'تاريخ اليوم الوطني بصيغة DD-MM حاضر؟'},
  {key:'flagEmoji',title:'وين علمنا 🇸🇦؟ خلّه ينوّر كلمة المرور'},
  {key:'currency',title:'اكتب رمز عملتنا بثلاث حروف بس'},
  {key:'domain',title:'امتداد رابط ينتمي للوطن، لا للعالم‫...‬تلميح‫:‬ مو .com'},
  {key:'unificationYears',title:'سنة توحيد المملكة الهجرية والميلادية ولكن غير متتالية'},
  {key:'founder',title:'مؤسس المملكة العربية السعودية ‫-طيب الله ثراه-‬'},
  {key:'visionYear',title:'رؤية المملكة باقي عليها 5 سنوات‫.......‬ تقريبًا'},
  {key:'noSpaces',title:'بدون مسافات نهائيًا…. الله لا يجيب البعد💚'},
  {key:'horse',title:'اسم فرس الملك عبدالعزيز المفضلة.. بنمشيها لك بالعربي…'},
  {key:'royalTitle',title:'لقب العائلة المالكة في السعودية'},
  {key:'currentKing',title:'ملك المملكة العربية السعودية الحالي ‫-‬ حفظه الله‫-‬'},
  {key:'emojisSP',title:'الخير له نخلة وللشر سيفين ‫(‬2 emojis)'},
  {key:'region',title:'اسم منطقة إدارية من المملكة‫...‬ مثلًا اللي أنت فيها الحين'},
  {key:'digitSum',title:'اجمع أرقامك يطلع 95 بالتمام'}
];

function ci(s,p){return s.toLowerCase().includes(p.toLowerCase())}
function sumDigits(s){return (s.match(/\d/g)||[]).map(Number).reduce((a,b)=>a+b,0)}
function hasUpper(s){return /[A-Z]/.test(s)}
function hasLower(s){return /[a-z]/.test(s)}
function hasDigit(s){return /\d/.test(s)}
function hasSpecial(s){return /[!@#\$%\^\&*()\-_=\+\[\]{};:'",.<>\/?\\|`~،؛؟«»]/.test(s)}
function containsAll(s,arr){return arr.every(e=>s.includes(e))}
function tokenIsIsolatedAnywhere(str,token){
  let i=0;while(true){
    const idx=str.indexOf(token,i);
    if(idx===-1)return false;
    const L=idx-1,R=idx+token.length;
    const ld=L>=0&&/\d/.test(str[L]);
    const rd=R<str.length&&/\d/.test(str[R]);
    if(!(ld||rd))return true;
    i=idx+1
  }
}
function findRegion(s){for(const r of A.regions){if(ci(s,r))return r}return null}

function validateAll(p){
  const s=p;const r={};
  r.minLen=s.length>=A.minLen;
  r.hasDigit=hasDigit(s);
  r.hasUpper=hasUpper(s);
  r.hasLower=hasLower(s);
  r.hasSpecial=hasSpecial(s);

  r.natDay=tokenIsIsolatedAnywhere(s,A.natDay);
  r.flagEmoji=s.includes(A.flagEmoji);
  r.currency=/[sS][aA][rR]/.test(s);
  r.domain=/(\.sa)/i.test(s);

  const has1932=tokenIsIsolatedAnywhere(s,A.unificationYearAD);
  const has1351=tokenIsIsolatedAnywhere(s,A.unificationYearAH);
  const i1932=s.indexOf(A.unificationYearAD),i1351=s.indexOf(A.unificationYearAH);
  let notConsecutive=true;
  if(i1932!==-1&&i1351!==-1){if(Math.abs(i1932-i1351)===A.unificationYearAD.length)notConsecutive=false}
  r.unificationYears=has1932&&has1351&&notConsecutive;

  r.founder=ci(s,A.founderName);

  r.visionYear=tokenIsIsolatedAnywhere(s,A.visionYear);
  r.noSpaces=!(/\s/.test(s));
  r.horse=ci(s,A.horseName);
  r.royalTitle=ci(s,A.royalTitle);
  r.currentKing=ci(s,A.currentKing2025);
  r.emojisSP=containsAll(s,A.swordsPalmEmojis);
  r.region=!!findRegion(s);
  r.digitSum=sumDigits(s)===95;

  return r
}

const container=document.getElementById('conditionsContainer');
const pwdInput=document.getElementById('pwd');
const digitSumBox=document.getElementById('digitSum');
const successRight=document.getElementById('successRight');
const successTop=document.getElementById('successTop');

let elems={};
let revealedCount=1;

function makeEl(c){
  const el=document.createElement('div');el.className='cond red';el.dataset.key=c.key;
  const left=document.createElement('div');left.textContent=c.title;left.className='cond-title';
  const right=document.createElement('div');right.className='status';
  const dot=document.createElement('span');dot.className='dot red';dot.id='dot-'+c.key;
  const label=document.createElement('span');label.id='label-'+c.key;label.textContent='غير متحقق';
  right.appendChild(label);right.appendChild(dot);el.appendChild(left);el.appendChild(right);return el
}

function init(){
  for(const c of CONDITIONS){
    const el=makeEl(c);
    elems[c.key+'__el']=el;
  }
  render(validateAll(pwdInput.value||''))
}

function findActiveIndex(results){
  for(let i=0;i<revealedCount;i++){
    const k=CONDITIONS[i].key;
    if(!results[k])return i
  }
  return -1
}

function cascadeReveal(results){
  while(findActiveIndex(results)===-1 && revealedCount<CONDITIONS.length){revealedCount++}
}

function render(results){
  digitSumBox.textContent=sumDigits(pwdInput.value||'');
  for(let i=0;i<revealedCount;i++){
    const k=CONDITIONS[i].key;
    const ref=elems[k+'__el'];
    if(!ref.isConnected)container.appendChild(ref)
  }

  const activeIdx=findActiveIndex(results);
  container.innerHTML='';

  if(activeIdx!==-1){
    const k=CONDITIONS[activeIdx].key;const el=elems[k+'__el'];
    el.classList.add('red');el.classList.remove('green');
    el.querySelector('#dot-'+k).className='dot red';
    el.querySelector('#label-'+k).textContent='غير متحقق';
    container.appendChild(el);
  }

  const rest=[];
  for(let i=0;i<revealedCount;i++){if(i!==activeIdx)rest.push(CONDITIONS[i])}

  const reds=rest.filter(c=>!results[c.key]).map(c=>elems[c.key+'__el']);
  const greens=rest.filter(c=>results[c.key]).map(c=>elems[c.key+'__el']);

  reds.forEach(el=>{
    const k=el.dataset.key;
    el.classList.add('red');el.classList.remove('green');
    el.querySelector('#dot-'+k).className='dot red';
    el.querySelector('#label-'+k).textContent='غير متحقق';
    container.appendChild(el)
  });

  greens.forEach(el=>{
    const k=el.dataset.key;
    el.classList.add('green');el.classList.remove('red');
    el.querySelector('#dot-'+k).className='dot green';
    el.querySelector('#label-'+k).textContent='متحقق';
    container.appendChild(el)
  });

  const allOk=CONDITIONS.every(c=>results[c.key]);
  successRight.style.display=allOk?'block':'none';
  successTop.style.display=allOk?'block':'none';
}

function tick(){
  const val=pwdInput.value||'';
  const res=validateAll(val);
  cascadeReveal(res);
  render(res);
}
pwdInput.addEventListener('input',tick);
init();
</script>
</body>
</html>
